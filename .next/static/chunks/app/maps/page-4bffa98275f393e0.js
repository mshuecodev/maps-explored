(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[28],{1281:(e,t,r)=>{Promise.resolve().then(r.bind(r,1001))},2255:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>u,A:()=>d});var n=r(5155),a=r(2115),l=r(399);let o=(0,r(9904).Wp)({apiKey:"AIzaSyBERXsbpdKHB-0SfHfAcbIBTAT1YgJqkvc",authDomain:"mshuecodev-daede.firebaseapp.com",projectId:"mshuecodev-daede",storageBucket:"mshuecodev-daede.firebasestorage.app",messagingSenderId:"453675518398",appId:"1:453675518398:web:af93634aeab4b8a3d051ef",measurementId:"G-JSR0LJVC4G"}),s=(0,l.xI)(o);(0,l.oM)(s,l.iM).catch(e=>{console.error("Error setting persistence:",e)});let i=new l.HF,c=(0,a.createContext)({user:null,loading:!0,token:null,login:async()=>{},handleLogout:async()=>{},handleRegister:async()=>{},loginWithGoogle:async()=>{}}),u=e=>{let{children:t}=e,[r,o]=(0,a.useState)(null),[u,d]=(0,a.useState)(!0),[g,f]=(0,a.useState)(null),h=async()=>{let e=await (0,l.df)(s,i);console.log("User logged in with Google:",e.user);let t=await (0,l.p9)(e.user);o(e.user),f(t)},p=async(e,t)=>{let r=await (0,l.x9)(s,e,t),n=await (0,l.p9)(r.user);o(r.user),f(n)},m=async(e,t)=>{let r=await (0,l.eJ)(s,e,t);console.log("User registered:",r.user);let n=await (0,l.p9)(r.user);o(r.user),f(n)},b=async()=>{await (0,l.CI)(s),o(null),f(null)},x=async()=>{r&&f(await (0,l.p9)(r,!0))};return(0,a.useEffect)(()=>{if(r){let e=setTimeout(()=>{console.log("Forcing logout after 30 minutes"),b()},18e5);return()=>clearTimeout(e)}},[r]),(0,a.useEffect)(()=>{let e=(0,l.iZ)(s,async e=>{o(e),d(!1),e?f(await (0,l.p9)(e)):f(null)});return()=>{e()}},[]),(0,a.useEffect)(()=>{let e=setInterval(x,9e5);return()=>clearInterval(e)},[r]),(0,n.jsx)(c.Provider,{value:{user:r,loading:u,token:g,login:p,handleRegister:m,handleLogout:b,loginWithGoogle:h},children:t})},d=()=>(0,a.useContext)(c)},1001:(e,t,r)=>{"use strict";let n;r.r(t),r.d(t,{default:()=>b});var a=r(5155),l=r(2115);r(8413);var o=r(2255),s=r(6046),i=r(1956),c=r.n(i);let u=c()(()=>Promise.all([r.e(761),r.e(219)]).then(r.bind(r,9219)).then(e=>e.MapContainer),{loadableGenerated:{webpack:()=>[9219]},ssr:!1}),d=c()(()=>Promise.all([r.e(761),r.e(219)]).then(r.bind(r,9219)).then(e=>e.TileLayer),{loadableGenerated:{webpack:()=>[9219]},ssr:!1}),g=c()(()=>Promise.all([r.e(761),r.e(219)]).then(r.bind(r,9219)).then(e=>e.Marker),{loadableGenerated:{webpack:()=>[9219]},ssr:!1}),f=c()(()=>Promise.all([r.e(761),r.e(219)]).then(r.bind(r,9219)).then(e=>e.Popup),{loadableGenerated:{webpack:()=>[9219]},ssr:!1}),h=c()(()=>Promise.all([r.e(761),r.e(219)]).then(r.bind(r,9219)).then(e=>e.Polyline),{loadableGenerated:{webpack:()=>[9219]},ssr:!1}),p=[51.505,-.09],m=()=>{let[e,t]=(0,l.useState)(null),[o,s]=(0,l.useState)(null),[i,c]=(0,l.useState)(null),[m,b]=(0,l.useState)("Loading address..."),[x,y]=(0,l.useState)(""),[w,j]=(0,l.useState)(""),[v,k]=(0,l.useState)([]),[N,P]=(0,l.useState)([]),[S,_]=(0,l.useState)(!1),[C,E]=(0,l.useState)(15),L=(0,l.useRef)(null),R=(0,l.useRef)(null);(0,l.useRef)(null);let M=async(e,t)=>{if(!e){t?k([]):P([]);return}_(!0);try{let r=e.replace(/ /g,"+"),n=await fetch("https://nominatim.openstreetmap.org/search.php?q=".concat(r,"&format=jsonv2"));if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));let a=await n.json();t?k(a):P(a)}catch(e){console.error("Error fetching suggestions:",e),t?k([]):P([])}finally{_(!1)}},O=(r,a)=>{let l=[parseFloat(r.lat),parseFloat(r.lon)];if(a?(t(l),y(r.display_name),k([])):(s(l),j(r.display_name),P([])),L.current){let t=n.latLngBounds([]);e&&t.extend(e),a&&t.extend(l),!a&&o&&t.extend(o),L.current.fitBounds(t,{padding:[50,50]})}},I=(e,t)=>{let r=e.target.value;R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{M(r,t)},500),t?(y(r),j("")):j(r)};async function A(e,t){try{let r=await fetch("https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=".concat(e,"&lon=").concat(t)),n=await r.json();n&&n.display_name?b(n.display_name):b("Address not found.")}catch(e){console.error("Error fetching address:",e),b("Failed to load address.")}}async function B(){if(e&&o)try{let t="https://router.project-osrm.org/route/v1/driving/".concat(e[1],",").concat(e[0],";").concat(o[1],",").concat(o[0],"?overview=full&geometries=polyline"),r=await fetch(t),n=await r.json();if(n.routes&&n.routes.length>0){let e=function(e){let t=[],r=0,n=0,a=0;for(;r<e.length;){let l,o=0,s=0;do s|=(31&(l=e.charCodeAt(r++)-63))<<o,o+=5;while(l>=32);n+=1&s?~(s>>1):s>>1,o=0,s=0;do s|=(31&(l=e.charCodeAt(r++)-63))<<o,o+=5;while(l>=32);a+=1&s?~(s>>1):s>>1,t.push([n/1e5,a/1e5])}return t}(n.routes[0].geometry);c(e)}else console.error("No routes found")}catch(e){console.error("Error fetching route:",e)}}return(0,l.useEffect)(()=>{(async function(){(n=await r.e(761).then(r.t.bind(r,8741,23))).Icon.Default.mergeOptions({iconUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png",iconRetinaUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png",shadowUrl:"https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png"})})(),navigator.geolocation&&(navigator.geolocation?navigator.geolocation.getCurrentPosition(e=>{let{latitude:r,longitude:n}=e.coords;t([r,n]),A(r,n)},e=>{console.error("Error getting location:",e),t(p),A(p[0],p[1])},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):(console.error("Geolocation is not supported by this browser."),t(p),A(p[0],p[1])))},[]),(0,l.useEffect)(()=>{if(L.current&&e&&o){let t=n.latLngBounds([e,o]);L.current.fitBounds(t,{padding:[50,50]})}B()},[e,o]),(0,a.jsxs)("div",{className:"relative w-full h-screen",children:[(0,a.jsxs)("div",{className:"absolute top-4 left-20 z-[1000] bg-white shadow-lg rounded-lg p-2 flex flex-col space-y-2",children:[(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("input",{type:"text",value:x,onChange:e=>I(e,!0),placeholder:"Search current location",className:"p-2 border border-gray-300 rounded-lg text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500"})}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsx)("input",{type:"text",placeholder:"Search destination",value:w,onChange:e=>I(e,!1),className:"p-2 border border-gray-300 rounded-lg text-sm text-gray-800 outline-none focus:ring-2 focus:ring-blue-500"})}),v.length>0&&!S&&(0,a.jsx)("ul",{className:"mt-2 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:v.map((e,t)=>(0,a.jsx)("li",{onClick:()=>O(e,!0),className:"p-2 text-gray-900 hover:bg-gray-200 cursor-pointer",children:e.display_name},t))}),N.length>0&&!S&&(0,a.jsx)("ul",{className:"mt-2 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:N.map((e,t)=>(0,a.jsx)("li",{onClick:()=>O(e,!1),className:"p-2 text-gray-900 hover:bg-gray-200 cursor-pointer",children:e.display_name},t))}),(0,a.jsx)("button",{onClick:()=>{L.current&&e&&L.current.setView(e,C,{animate:!0})},className:"mt-4 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",children:"Recenter Map"}),S&&(0,a.jsxs)("div",{className:"mt-2 flex items-center justify-center text-gray-500",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-blue-500 border-opacity-75"}),(0,a.jsx)("span",{className:"ml-2 text-sm",children:"Loading..."})]}),0===v.length&&x&&!S&&(0,a.jsx)("ul",{className:"mt-2 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:(0,a.jsx)("li",{className:"p-2 text-gray-500 text-center",children:"No location found"})})]}),e&&(0,a.jsxs)(u,{center:e||p,zoom:C,scrollWheelZoom:!0,className:"w-full h-full",ref:L,children:[(0,a.jsx)(d,{attribution:'\xa9 <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),(0,a.jsx)(g,{position:e,draggable:!0,eventHandlers:{dragend:e=>{let r=e.target.getLatLng();t([r.lat,r.lng]),A(r.lat,r.lng)}},children:(0,a.jsx)(f,{children:m})}),o&&(0,a.jsx)(g,{position:o,draggable:!0,eventHandlers:{dragend:e=>{let t=e.target.getLatLng();s([t.lat,t.lng]),A(t.lat,t.lng)}},children:(0,a.jsx)(f,{children:m})}),i&&(0,a.jsx)(h,{positions:i,color:"red",weight:4})]})]})};function b(){let{loading:e,token:t,handleLogout:r}=(0,o.A)(),n=(0,s.useRouter)();return((0,l.useEffect)(()=>{e||t||n.push("/login")},[t,e,n]),e)?(0,a.jsx)("main",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})})}):(0,a.jsx)("main",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-r from-blue-500 to-purple-600",children:(0,a.jsx)("div",{className:"w-full ",children:(0,a.jsxs)("div",{className:"text-center p-8 bg-white rounded-lg shadow-lg",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-4",children:[(0,a.jsx)("button",{onClick:()=>n.back(),className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition",children:"Back"}),(0,a.jsx)("button",{onClick:r,className:"px-6 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 transition",children:"Logout"})]}),(0,a.jsx)(m,{})]})})})}},6046:(e,t,r)=>{"use strict";var n=r(6658);r.o(n,"useRouter")&&r.d(t,{useRouter:function(){return n.useRouter}})},1956:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return a}});let n=r(306)._(r(580));function a(e,t){var r;let a={};"function"==typeof e&&(a.loader=e);let l={...a,...t};return(0,n.default)({...l,modules:null==(r=l.loadableGenerated)?void 0:r.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},9827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return a}});let n=r(3719);function a(e){let{reason:t,children:r}=e;if("undefined"==typeof window)throw new n.BailoutToCSRError(t);return r}},580:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return c}});let n=r(5155),a=r(2115),l=r(9827),o=r(9214);function s(e){return{default:e&&"default"in e?e.default:e}}let i={loader:()=>Promise.resolve(s(()=>null)),loading:null,ssr:!0},c=function(e){let t={...i,...e},r=(0,a.lazy)(()=>t.loader().then(s)),c=t.loading;function u(e){let s=c?(0,n.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,i=!t.ssr||!!t.loading,u=i?a.Suspense:a.Fragment,d=t.ssr?(0,n.jsxs)(n.Fragment,{children:["undefined"==typeof window?(0,n.jsx)(o.PreloadChunks,{moduleIds:t.modules}):null,(0,n.jsx)(r,{...e})]}):(0,n.jsx)(l.BailoutToCSR,{reason:"next/dynamic",children:(0,n.jsx)(r,{...e})});return(0,n.jsx)(u,{...i?{fallback:s}:{},children:d})}return u.displayName="LoadableComponent",u}},9214:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return s}});let n=r(5155),a=r(7650),l=r(5861),o=r(8284);function s(e){let{moduleIds:t}=e;if("undefined"!=typeof window)return null;let r=l.workAsyncStorage.getStore();if(void 0===r)return null;let s=[];if(r.reactLoadableManifest&&t){let e=r.reactLoadableManifest;for(let r of t){if(!e[r])continue;let t=e[r].files;s.push(...t)}}return 0===s.length?null:(0,n.jsx)(n.Fragment,{children:s.map(e=>{let t=r.assetPrefix+"/_next/"+(0,o.encodeURIPath)(e);return e.endsWith(".css")?(0,n.jsx)("link",{precedence:"dynamic",href:t,rel:"stylesheet",as:"style"},e):((0,a.preload)(t,{as:"script",fetchPriority:"low"}),null)})})}},8413:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[484,523,361,441,517,358],()=>t(1281)),_N_E=e.O()}]);